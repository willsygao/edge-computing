## 目标
- 仅在“任务完成”时判断当前连接服务器与之前卸载的服务器是否相同；若不同，则将 `agent.state.time_cur += (task.exe_data * context_delay_number)`。

## 现状与定位
- `context_trans_delay` 仅在 `edge_cost` 里计算，未生效（参见 `onpolicy/envs/my/core.py:376–382`，其中 `# agent.state.time_cur += context_trans_delay` 被注释）。
- 任务完成的时间与能耗累加发生在 `step` 的完成队列处理处（`onpolicy/envs/my/core.py:250–255`）。
- 之前卸载的服务器 ID 通过 `agent.state.offload_pass_t` 维护，但在卸载时会被直接覆盖为当前服务器（`onpolicy/envs/my/core.py:356`），无法在“完成时”对比前一个值。

## 修改点
1. 在 `AgentState` 增加字段 `offload_prev_t`（初值为 0），用于保存“上一次卸载的服务器 ID”（位置：`onpolicy/envs/my/core.py:47` 附近）。
2. 在 `edge_cost` 更新卸载服务器 ID 前，先把旧值保存到 `offload_prev_t`，然后再写入当前值到 `offload_pass_t`（位置：`onpolicy/envs/my/core.py:353–357`）。不在此处修改 `time_cur`。
3. 在 `step` 处理“完成任务”分支，累加 `trans_t + t.time_total` 后，新增完成时判断：
   - 取当前完成任务的服务器 `cur_sid = s.id`（上下文：`onpolicy/envs/my/core.py:246–258`）。
   - 取之前卸载服务器 `prev_sid = agent.state.offload_prev_t`。
   - 若 `prev_sid != 0` 且 `cur_sid != prev_sid`，则执行 `agent.state.time_cur += agent.task.exe_data * self.context_delay_number`。
4. 保持“失败任务”分支不变，不在失败时引入上下文迁移时延（位置：`onpolicy/envs/my/core.py:261–266`）。
5. `local_cost` 保持现状，仅把 `offload_pass_t` 置为 0；不引入上下文迁移时延（位置：`onpolicy/envs/my/core.py:333–346`）。

## 代码参考（便于跳转）
- 完成队列时延累加：`onpolicy/envs/my/core.py:250–255`
- 上下文迁移注释位置：`onpolicy/envs/my/core.py:376–382`
- 卸载服务器 ID 更新：`onpolicy/envs/my/core.py:353–357`
- 本地计算：`onpolicy/envs/my/core.py:333–346`

## 说明
- 不在传输阶段累加上下文时延，改为在任务完成的时刻进行判断与计入，完全符合“任务完成时才判断并加时延”的新逻辑需求。
- 无需对奖励/效用接口作额外改动，`time_cur` 增量自然体现在后续计算中。